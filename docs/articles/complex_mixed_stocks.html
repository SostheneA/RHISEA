<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing complex mixed-stock fisheries with 20 stocks • RHISEA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing complex mixed-stock fisheries with 20 stocks">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RHISEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/RHISEA_vs_Fortran.html">Verifying compatibility: RHISEA (R) vs FORTRAN HISEA</a></li>
    <li><a class="dropdown-item" href="../articles/Custom_Classification_Models.html">Applying HISEA estimators to custom classification models with run_hisea_estimates</a></li>
    <li><a class="dropdown-item" href="../articles/RHISEA_data_type.html">Two input paths in RHISEA: run_hisea_all with HISEA-style files or Dataframes</a></li>
    <li><a class="dropdown-item" href="../articles/Multiple_Classifiers.html">Comparing built-in classification methods in RHISEA for mixed-stock analysis</a></li>
    <li><a class="dropdown-item" href="../articles/RHISEA_comprehensive_Guide.html">Comprehensive Guide to the RHISEA Package for Mixed-Stock Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/complex_mixed_stocks.html">Analyzing complex mixed-stock fisheries with 20 stocks</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="https://github.com/SostheneA/RHISEA" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analyzing complex mixed-stock fisheries with 20 stocks</h1>
                        <h4 data-toc-skip class="author">Sosthene
Akia</h4>
            <address class="author_afil">
      Fisheries and Oceans
Canada<br><a class="author_email" href="mailto:#"></a><a href="mailto:sosthene.akia@dfo-mpo.ca" class="email">sosthene.akia@dfo-mpo.ca</a>
      </address>
                              <h4 data-toc-skip class="author">Alex
Hanke</h4>
            <address class="author_afil">
      Fisheries and Oceans
Canada<br><a class="author_email" href="mailto:#"></a><a href="mailto:alex.hanke@dfo-mpo.ca" class="email">alex.hanke@dfo-mpo.ca</a>
      </address>
                  
            <h4 data-toc-skip class="date">2025-10-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/SostheneA/RHISEA/blob/HEAD/vignettes/complex_mixed_stocks.Rmd"><code>vignettes/complex_mixed_stocks.Rmd</code></a></small>
      <div class="d-none name"><code>complex_mixed_stocks.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial demonstrates the capability of the RHISEA package to
estimate stock proportions in complex mixed-stock fisheries involving 20
distinct source populations. It guides through generating simulated
classification outputs (pseudo-classes, likelihoods, phi matrix),
applying the five classical HISEA estimators, and visualizing the
estimates.</p>
<hr>
</div>
<div class="section level2">
<h2 id="data-simulation-of-classification-outputs">Data Simulation of Classification Outputs<a class="anchor" aria-label="anchor" href="#data-simulation-of-classification-outputs"></a>
</h2>
<p>We simulate a mixture of 1000 fish from 20 stocks, generating
pseudo-class assignments, likelihood matrices, and a phi matrix
reflecting typical classification errors.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">np</span> <span class="op">&lt;-</span> <span class="fl">20</span>  <span class="co"># number of populations</span></span>
<span><span class="va">n_mixture</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Create stock names</span></span>
<span><span class="va">stocks_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Stock_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">np</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate pseudo-classes randomly among stocks</span></span>
<span><span class="va">pseudo_classes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">np</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">n_mixture</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate likelihood matrix: concentrated probabilities near true class + noise</span></span>
<span><span class="va">likelihoods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_mixture</span> <span class="op">*</span> <span class="va">np</span>, min <span class="op">=</span> <span class="fl">0.01</span>, max <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_mixture</span>, ncol <span class="op">=</span> <span class="va">np</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_mixture</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">likelihoods</span><span class="op">[</span><span class="va">i</span>, <span class="va">pseudo_classes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">likelihoods</span><span class="op">[</span><span class="va">i</span>, <span class="va">pseudo_classes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.8</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Normalize rows to sum to 1</span></span>
<span><span class="va">likelihoods</span> <span class="op">&lt;-</span> <span class="va">likelihoods</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">likelihoods</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">likelihoods</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">stocks_names</span></span>
<span></span>
<span><span class="co"># Create a phi matrix with varying diagonal and asymmetric misclassification</span></span>
<span><span class="va">base_correct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">np</span>, min <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">phi_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">np</span>, ncol <span class="op">=</span> <span class="va">np</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">np</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">phi_matrix</span><span class="op">[</span><span class="va">j</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">base_correct</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>  <span class="va">off_diag_total</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">base_correct</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>  <span class="va">off_diag_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">np</span>, <span class="va">j</span><span class="op">)</span></span>
<span>  <span class="va">off_diag_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">off_diag_indices</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">off_diag_vals</span> <span class="op">&lt;-</span> <span class="va">off_diag_vals</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">off_diag_vals</span><span class="op">)</span> <span class="op">*</span> <span class="va">off_diag_total</span></span>
<span>  <span class="va">phi_matrix</span><span class="op">[</span><span class="va">off_diag_indices</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">off_diag_vals</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">phi_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">stocks_names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">phi_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">stocks_names</span></span>
<span></span>
<span><span class="co"># Check columns sum to 1 (optional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">phi_matrix</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Stock_1  Stock_2  Stock_3  Stock_4  Stock_5  Stock_6  Stock_7  Stock_8 </span></span>
<span><span class="co">#&gt;        1        1        1        1        1        1        1        1 </span></span>
<span><span class="co">#&gt;  Stock_9 Stock_10 Stock_11 Stock_12 Stock_13 Stock_14 Stock_15 Stock_16 </span></span>
<span><span class="co">#&gt;        1        1        1        1        1        1        1        1 </span></span>
<span><span class="co">#&gt; Stock_17 Stock_18 Stock_19 Stock_20 </span></span>
<span><span class="co">#&gt;        1        1        1        1</span></span>
<span></span>
<span><span class="co"># View phi_matrix with margins (optional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html" class="external-link">addmargins</a></span><span class="op">(</span><span class="va">phi_matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Stock_1      Stock_2      Stock_3     Stock_4     Stock_5</span></span>
<span><span class="co">#&gt; Stock_1  0.515953101 0.0041155264 0.0292964932 0.018147941 0.039567227</span></span>
<span><span class="co">#&gt; Stock_2  0.016399560 0.7662633701 0.0271431485 0.017632660 0.015991717</span></span>
<span><span class="co">#&gt; Stock_3  0.021336830 0.0131697562 0.6442477173 0.019352912 0.027655418</span></span>
<span><span class="co">#&gt; Stock_4  0.038675027 0.0004900685 0.0093920334 0.762307803 0.018568189</span></span>
<span><span class="co">#&gt; Stock_5  0.034708964 0.0035953989 0.0230996338 0.005918231 0.591078549</span></span>
<span><span class="co">#&gt; Stock_6  0.006833039 0.0277407377 0.0168758783 0.013594629 0.001417044</span></span>
<span><span class="co">#&gt; Stock_7  0.032757354 0.0083856619 0.0159738885 0.013485520 0.024035790</span></span>
<span><span class="co">#&gt; Stock_8  0.030562028 0.0272898927 0.0027776105 0.017937584 0.025426034</span></span>
<span><span class="co">#&gt; Stock_9  0.014078071 0.0135493901 0.0020111706 0.008526801 0.001727551</span></span>
<span><span class="co">#&gt; Stock_10 0.010621316 0.0029454377 0.0179568289 0.004823619 0.022788807</span></span>
<span><span class="co">#&gt; Stock_11 0.003088895 0.0125419700 0.0343282568 0.011382662 0.037673569</span></span>
<span><span class="co">#&gt; Stock_12 0.015659838 0.0227492766 0.0282822327 0.008468581 0.030787584</span></span>
<span><span class="co">#&gt; Stock_13 0.043140528 0.0187658209 0.0020589782 0.010375384 0.029383914</span></span>
<span><span class="co">#&gt; Stock_14 0.037782215 0.0174790923 0.0105939338 0.015786042 0.012952957</span></span>
<span><span class="co">#&gt; Stock_15 0.050220919 0.0069615753 0.0225589496 0.020892927 0.030709887</span></span>
<span><span class="co">#&gt; Stock_16 0.033811619 0.0045071239 0.0295957155 0.009747873 0.032522366</span></span>
<span><span class="co">#&gt; Stock_17 0.049137227 0.0141023192 0.0301004496 0.003354857 0.009361894</span></span>
<span><span class="co">#&gt; Stock_18 0.006291651 0.0083869193 0.0239025454 0.012460253 0.029464039</span></span>
<span><span class="co">#&gt; Stock_19 0.003255807 0.0200515695 0.0009966584 0.019651910 0.012808647</span></span>
<span><span class="co">#&gt; Stock_20 0.035686008 0.0069090928 0.0288078768 0.006151811 0.006078817</span></span>
<span><span class="co">#&gt; Sum      1.000000000 1.0000000000 1.0000000000 1.000000000 1.000000000</span></span>
<span><span class="co">#&gt;              Stock_6      Stock_7     Stock_8      Stock_9    Stock_10</span></span>
<span><span class="co">#&gt; Stock_1  0.015668884 0.0100867253 0.032074410 0.0194618401 0.013532206</span></span>
<span><span class="co">#&gt; Stock_2  0.023462109 0.0014425261 0.041342260 0.0270625308 0.013849359</span></span>
<span><span class="co">#&gt; Stock_3  0.003090806 0.0055064461 0.030117462 0.0147826851 0.001001193</span></span>
<span><span class="co">#&gt; Stock_4  0.006275546 0.0092295970 0.036970138 0.0153154874 0.014901561</span></span>
<span><span class="co">#&gt; Stock_5  0.019093211 0.0055362768 0.045367201 0.0315630729 0.007705665</span></span>
<span><span class="co">#&gt; Stock_6  0.749965485 0.0060799970 0.021841286 0.0275002055 0.011814267</span></span>
<span><span class="co">#&gt; Stock_7  0.016121807 0.8930020857 0.039204365 0.0122678788 0.020935100</span></span>
<span><span class="co">#&gt; Stock_8  0.012471417 0.0092265527 0.500468225 0.0023981346 0.004264566</span></span>
<span><span class="co">#&gt; Stock_9  0.012566286 0.0033063210 0.037666571 0.6737048865 0.002031941</span></span>
<span><span class="co">#&gt; Stock_10 0.013735529 0.0102173655 0.025059920 0.0242373251 0.755954288</span></span>
<span><span class="co">#&gt; Stock_11 0.001937110 0.0047357350 0.018964059 0.0150312577 0.026081695</span></span>
<span><span class="co">#&gt; Stock_12 0.022343155 0.0087400234 0.025948786 0.0008418196 0.007766540</span></span>
<span><span class="co">#&gt; Stock_13 0.014293802 0.0020079676 0.015787334 0.0182326133 0.010695942</span></span>
<span><span class="co">#&gt; Stock_14 0.021735380 0.0003024693 0.015675732 0.0058215690 0.024224621</span></span>
<span><span class="co">#&gt; Stock_15 0.010201781 0.0046073445 0.025899854 0.0054921450 0.029172790</span></span>
<span><span class="co">#&gt; Stock_16 0.015068336 0.0045920110 0.023772048 0.0294391159 0.007263361</span></span>
<span><span class="co">#&gt; Stock_17 0.008730833 0.0047122079 0.001673442 0.0310654827 0.015227206</span></span>
<span><span class="co">#&gt; Stock_18 0.006876156 0.0015503689 0.022984761 0.0160295257 0.018308053</span></span>
<span><span class="co">#&gt; Stock_19 0.023464967 0.0054422971 0.033725378 0.0113200414 0.011858093</span></span>
<span><span class="co">#&gt; Stock_20 0.002897403 0.0096756822 0.005456769 0.0184323831 0.003411556</span></span>
<span><span class="co">#&gt; Sum      1.000000000 1.0000000000 1.000000000 1.0000000000 1.000000000</span></span>
<span><span class="co">#&gt;              Stock_11    Stock_12     Stock_13    Stock_14     Stock_15</span></span>
<span><span class="co">#&gt; Stock_1  0.0017274446 0.021015257 0.0081071293 0.005936227 0.0175105225</span></span>
<span><span class="co">#&gt; Stock_2  0.0007623730 0.023253759 0.0057699656 0.006524679 0.0204463051</span></span>
<span><span class="co">#&gt; Stock_3  0.0094362344 0.022407262 0.0033320383 0.002145133 0.0172307262</span></span>
<span><span class="co">#&gt; Stock_4  0.0090182303 0.012357375 0.0126057205 0.007945134 0.0135220422</span></span>
<span><span class="co">#&gt; Stock_5  0.0040938219 0.020089013 0.0024473974 0.005617079 0.0210976658</span></span>
<span><span class="co">#&gt; Stock_6  0.0110743899 0.017434838 0.0039209608 0.004209640 0.0237182809</span></span>
<span><span class="co">#&gt; Stock_7  0.0064764998 0.014731097 0.0011045917 0.009239328 0.0180282859</span></span>
<span><span class="co">#&gt; Stock_8  0.0112442410 0.013295307 0.0021408528 0.007454430 0.0010339829</span></span>
<span><span class="co">#&gt; Stock_9  0.0101661707 0.011963003 0.0054536017 0.002152062 0.0149108840</span></span>
<span><span class="co">#&gt; Stock_10 0.0018880318 0.008182897 0.0018692539 0.002418468 0.0167209049</span></span>
<span><span class="co">#&gt; Stock_11 0.8784382979 0.017012843 0.0042747250 0.001656925 0.0051507069</span></span>
<span><span class="co">#&gt; Stock_12 0.0102006988 0.703057560 0.0087079601 0.010263217 0.0076859329</span></span>
<span><span class="co">#&gt; Stock_13 0.0092884821 0.006644265 0.8936902964 0.010952295 0.0126404478</span></span>
<span><span class="co">#&gt; Stock_14 0.0109319063 0.004536354 0.0022771246 0.877191967 0.0198804529</span></span>
<span><span class="co">#&gt; Stock_15 0.0004807987 0.017879073 0.0108081699 0.007833681 0.7426280182</span></span>
<span><span class="co">#&gt; Stock_16 0.0030613865 0.011625484 0.0104162196 0.007209026 0.0012087324</span></span>
<span><span class="co">#&gt; Stock_17 0.0101397886 0.009969175 0.0032167969 0.001712478 0.0222025814</span></span>
<span><span class="co">#&gt; Stock_18 0.0010386949 0.019019147 0.0004860685 0.011424572 0.0008538011</span></span>
<span><span class="co">#&gt; Stock_19 0.0069504989 0.020505385 0.0126497283 0.006734544 0.0214157064</span></span>
<span><span class="co">#&gt; Stock_20 0.0035820099 0.025020905 0.0067213989 0.011379114 0.0021140197</span></span>
<span><span class="co">#&gt; Sum      1.0000000000 1.000000000 1.0000000000 1.000000000 1.0000000000</span></span>
<span><span class="co">#&gt;             Stock_16    Stock_17     Stock_18     Stock_19     Stock_20</span></span>
<span><span class="co">#&gt; Stock_1  0.002101779 0.037427495 0.0217211853 0.0348396813 0.0034985787</span></span>
<span><span class="co">#&gt; Stock_2  0.011842199 0.010750733 0.0345918216 0.0087894209 0.0067749576</span></span>
<span><span class="co">#&gt; Stock_3  0.010460356 0.034474186 0.0066291183 0.0442818033 0.0077715573</span></span>
<span><span class="co">#&gt; Stock_4  0.007418566 0.036739782 0.0008703459 0.0259374966 0.0066816950</span></span>
<span><span class="co">#&gt; Stock_5  0.013119025 0.027188454 0.0227211900 0.0172199475 0.0084181353</span></span>
<span><span class="co">#&gt; Stock_6  0.008838456 0.035981409 0.0014206403 0.0250595602 0.0046560220</span></span>
<span><span class="co">#&gt; Stock_7  0.003472510 0.033373383 0.0198056972 0.0459689768 0.0073499683</span></span>
<span><span class="co">#&gt; Stock_8  0.002483678 0.024615572 0.0359055379 0.0001953481 0.0014051571</span></span>
<span><span class="co">#&gt; Stock_9  0.005098729 0.024134937 0.0136911469 0.0035661781 0.0076770030</span></span>
<span><span class="co">#&gt; Stock_10 0.001502844 0.009288801 0.0190670216 0.0486737132 0.0032983811</span></span>
<span><span class="co">#&gt; Stock_11 0.012053943 0.031799213 0.0293085934 0.0254145115 0.0020043289</span></span>
<span><span class="co">#&gt; Stock_12 0.004154802 0.037104700 0.0065049722 0.0082843963 0.0064484314</span></span>
<span><span class="co">#&gt; Stock_13 0.010204285 0.015207360 0.0028325913 0.0247634569 0.0075897190</span></span>
<span><span class="co">#&gt; Stock_14 0.001903902 0.020126260 0.0240904293 0.0015154371 0.0061814417</span></span>
<span><span class="co">#&gt; Stock_15 0.011973025 0.026094470 0.0240018721 0.0390386310 0.0084040880</span></span>
<span><span class="co">#&gt; Stock_16 0.874940936 0.012300655 0.0007883956 0.0041421743 0.0076961787</span></span>
<span><span class="co">#&gt; Stock_17 0.003307405 0.520913596 0.0314630065 0.0344818355 0.0063540766</span></span>
<span><span class="co">#&gt; Stock_18 0.005963946 0.025861154 0.6481440785 0.0476297804 0.0060663269</span></span>
<span><span class="co">#&gt; Stock_19 0.007931185 0.034108763 0.0248599857 0.5413080201 0.0003680724</span></span>
<span><span class="co">#&gt; Stock_20 0.001228429 0.002509079 0.0315823706 0.0188896310 0.8913558810</span></span>
<span><span class="co">#&gt; Sum      1.000000000 1.000000000 1.0000000000 1.0000000000 1.0000000000</span></span>
<span><span class="co">#&gt;                 Sum</span></span>
<span><span class="co">#&gt; Stock_1   0.8517897</span></span>
<span><span class="co">#&gt; Stock_2   1.0800955</span></span>
<span><span class="co">#&gt; Stock_3   0.9384296</span></span>
<span><span class="co">#&gt; Stock_4   1.0452218</span></span>
<span><span class="co">#&gt; Stock_5   0.9096779</span></span>
<span><span class="co">#&gt; Stock_6   1.0199768</span></span>
<span><span class="co">#&gt; Stock_7   1.2357198</span></span>
<span><span class="co">#&gt; Stock_8   0.7325962</span></span>
<span><span class="co">#&gt; Stock_9   0.8679827</span></span>
<span><span class="co">#&gt; Stock_10  1.0012508</span></span>
<span><span class="co">#&gt; Stock_11  1.1728793</span></span>
<span><span class="co">#&gt; Stock_12  0.9740005</span></span>
<span><span class="co">#&gt; Stock_13  1.1585555</span></span>
<span><span class="co">#&gt; Stock_14  1.1309893</span></span>
<span><span class="co">#&gt; Stock_15  1.0958600</span></span>
<span><span class="co">#&gt; Stock_16  1.1237088</span></span>
<span><span class="co">#&gt; Stock_17  0.8112267</span></span>
<span><span class="co">#&gt; Stock_18  0.9127418</span></span>
<span><span class="co">#&gt; Stock_19  0.8194073</span></span>
<span><span class="co">#&gt; Stock_20  1.1178902</span></span>
<span><span class="co">#&gt; Sum      20.0000000</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="running-classic-hisea-estimators-with-run_hisea_estimates">Running Classic HISEA Estimators with
<code>run_hisea_estimates()</code><a class="anchor" aria-label="anchor" href="#running-classic-hisea-estimators-with-run_hisea_estimates"></a>
</h2>
<p>Using the simulated classification outputs and phi matrix, we run all
five classical estimators and summarize results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_hisea_estimates.html">run_hisea_estimates</a></span><span class="op">(</span></span>
<span>  pseudo_classes <span class="op">=</span> <span class="va">pseudo_classes</span>,</span>
<span>  likelihoods <span class="op">=</span> <span class="va">likelihoods</span>,</span>
<span>  phi_matrix <span class="op">=</span> <span class="va">phi_matrix</span>,</span>
<span>  np <span class="op">=</span> <span class="va">np</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"BOOTSTRAP"</span>,</span>
<span>  stocks_names <span class="op">=</span> <span class="va">stocks_names</span>,</span>
<span>  export_csv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="displaying-and-plotting-results">Displaying and Plotting Results<a class="anchor" aria-label="anchor" href="#displaying-and-plotting-results"></a>
</h2>
<p>We print mean estimates by estimator and stock, and visualize
estimated stock proportions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">mean_estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt;               RAW       COOK      COOKC         EM         ML</span></span>
<span><span class="co">#&gt; Stock_1  0.051826 0.06349794 0.06349794 0.06349775 0.05337111</span></span>
<span><span class="co">#&gt; Stock_2  0.049702 0.04305177 0.04305177 0.04305177 0.04972537</span></span>
<span><span class="co">#&gt; Stock_3  0.050976 0.05167302 0.05167302 0.05167307 0.05214892</span></span>
<span><span class="co">#&gt; Stock_4  0.050131 0.04376930 0.04376930 0.04376938 0.04991148</span></span>
<span><span class="co">#&gt; Stock_5  0.051238 0.05606193 0.05606193 0.05606199 0.05258102</span></span>
<span><span class="co">#&gt; Stock_6  0.058765 0.05872793 0.05872793 0.05872796 0.06400023</span></span>
<span><span class="co">#&gt; Stock_7  0.054044 0.03738428 0.03738428 0.03738435 0.05667866</span></span>
<span><span class="co">#&gt; Stock_8  0.054003 0.08529196 0.08529196 0.08529160 0.05522833</span></span>
<span><span class="co">#&gt; Stock_9  0.045839 0.05207311 0.05207311 0.05207310 0.04327711</span></span>
<span><span class="co">#&gt; Stock_10 0.045704 0.04026738 0.04026738 0.04026740 0.04282068</span></span>
<span><span class="co">#&gt; Stock_11 0.053292 0.04223917 0.04223917 0.04223918 0.05501416</span></span>
<span><span class="co">#&gt; Stock_12 0.039023 0.03423555 0.03423555 0.03423559 0.03065920</span></span>
<span><span class="co">#&gt; Stock_13 0.042746 0.03085237 0.03085237 0.03085241 0.03832266</span></span>
<span><span class="co">#&gt; Stock_14 0.044235 0.03553544 0.03553544 0.03553541 0.03980201</span></span>
<span><span class="co">#&gt; Stock_15 0.043759 0.03142130 0.03142130 0.03142166 0.03988517</span></span>
<span><span class="co">#&gt; Stock_16 0.056526 0.04892501 0.04892501 0.04892502 0.06183547</span></span>
<span><span class="co">#&gt; Stock_17 0.048703 0.06321598 0.06321598 0.06321599 0.04806682</span></span>
<span><span class="co">#&gt; Stock_18 0.041982 0.03965453 0.03965453 0.03965487 0.03556947</span></span>
<span><span class="co">#&gt; Stock_19 0.068267 0.10012542 0.10012542 0.10012490 0.08223484</span></span>
<span><span class="co">#&gt; Stock_20 0.049239 0.04199661 0.04199661 0.04199660 0.04886728</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">sd_estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  RAW        COOK       COOKC          EM         ML</span></span>
<span><span class="co">#&gt; Stock_1  0.007177412 0.014486231 0.014486231 0.014485132 0.01249764</span></span>
<span><span class="co">#&gt; Stock_2  0.006744678 0.009052919 0.009052919 0.009052917 0.01176143</span></span>
<span><span class="co">#&gt; Stock_3  0.006741726 0.010842148 0.010842148 0.010842000 0.01184443</span></span>
<span><span class="co">#&gt; Stock_4  0.006958323 0.009374213 0.009374213 0.009374185 0.01207818</span></span>
<span><span class="co">#&gt; Stock_5  0.006979116 0.012271572 0.012271572 0.012271218 0.01229636</span></span>
<span><span class="co">#&gt; Stock_6  0.007563133 0.010328196 0.010328196 0.010328195 0.01307650</span></span>
<span><span class="co">#&gt; Stock_7  0.007076167 0.008185961 0.008185961 0.008185942 0.01233291</span></span>
<span><span class="co">#&gt; Stock_8  0.007159766 0.014751912 0.014751912 0.014751827 0.01254367</span></span>
<span><span class="co">#&gt; Stock_9  0.006360309 0.009613181 0.009613181 0.009613164 0.01118631</span></span>
<span><span class="co">#&gt; Stock_10 0.006397133 0.008634590 0.008634590 0.008634564 0.01130943</span></span>
<span><span class="co">#&gt; Stock_11 0.007110788 0.008307709 0.008307709 0.008307706 0.01226613</span></span>
<span><span class="co">#&gt; Stock_12 0.005884650 0.008598964 0.008598964 0.008598836 0.01025705</span></span>
<span><span class="co">#&gt; Stock_13 0.006539591 0.007495343 0.007495343 0.007495314 0.01165050</span></span>
<span><span class="co">#&gt; Stock_14 0.006440594 0.007500034 0.007500034 0.007500033 0.01116439</span></span>
<span><span class="co">#&gt; Stock_15 0.006554989 0.009147913 0.009147913 0.009147406 0.01153213</span></span>
<span><span class="co">#&gt; Stock_16 0.007348832 0.008562835 0.008562835 0.008562838 0.01279585</span></span>
<span><span class="co">#&gt; Stock_17 0.006738115 0.013496814 0.013496814 0.013496140 0.01179456</span></span>
<span><span class="co">#&gt; Stock_18 0.006224984 0.009932089 0.009932089 0.009931712 0.01083288</span></span>
<span><span class="co">#&gt; Stock_19 0.007870048 0.014951969 0.014951969 0.014951924 0.01370702</span></span>
<span><span class="co">#&gt; Stock_20 0.006801333 0.007794660 0.007794660 0.007794652 0.01184667</span></span>
<span></span>
<span><span class="co"># Convert to tidy format for plotting</span></span>
<span><span class="va">estimates_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">mean_estimates</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Stock <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">Stock</span>, names_to <span class="op">=</span> <span class="st">"Estimator"</span>, values_to <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">estimates_long</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Estimator</span>, y <span class="op">=</span> <span class="va">Proportion</span>, fill <span class="op">=</span> <span class="va">Stock</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Estimated Stock Proportions by HISEA Estimator"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Estimated Proportion"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Estimator"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="complex_mixed_stocks_files/figure-html/plot-complex-mixed-stocks-1.png" alt="Analyzing complex mixed-stock fisheries with 20 stocks" width="672"><p class="caption">
Analyzing complex mixed-stock fisheries with 20 stocks
</p>
</div>
<hr>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This tutorial illustrates that RHISEA is well suited for mixed-stock
fisheries with numerous source populations. The simulation and
estimation workflow scales to 20 stocks, producing robust and unbiased
estimates using all classical HISEA estimators. This confirms the
method’s applicability for complex, high-dimensional stock composition
problems.</p>
<hr>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sosthene Akia, Alex Hanke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
