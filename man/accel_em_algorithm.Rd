% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate.R
\name{accel_em_algorithm}
\alias{accel_em_algorithm}
\title{Accelerated Expectation-Maximization (EM) Algorithm}
\usage{
accel_em_algorithm(
  likelihood,
  np,
  freq = NULL,
  max_iter = 100,
  tol = 1e-06,
  verbose = FALSE,
  save_theta_path = NULL
)
}
\arguments{
\item{likelihood}{A numeric matrix (N_rows x N_populations) where \code{likelihood[i, j]}
is $P(Data_i | Stock_j)$ or a value proportional to it.
N_rows can be N_samples (for Theta5) or N_populations (for Theta4).}

\item{np}{Integer, the number of populations (stocks). Should match \code{ncol(likelihood)}.}

\item{freq}{Optional numeric vector of frequencies/weights for each "observation"
(row in \code{likelihood}). Length must match \code{nrow(likelihood)}.
Defaults to \code{rep(1, nrow(likelihood))}.}

\item{max_iter}{Integer, the maximum number of iterations for the EM algorithm.}

\item{tol}{Numeric, the convergence tolerance. The algorithm stops if the maximum
absolute change in any \code{theta} component is less than \code{tol}.}

\item{verbose}{Logical, if TRUE, prints iteration number and current theta estimates.}

\item{save_theta_path}{Optional character string. If provided, the history of theta
estimates at each iteration is saved to a CSV file at this path.}
}
\value{
A numeric vector of estimated stock proportions (theta), length \code{np}.
}
\description{
Estimates mixing proportions (theta) using an EM algorithm with a simple acceleration step.
The acceleration is attempted based on changes in theta over iterations and log-likelihood improvement.
This is a simplified interpretation of HISEA's ACCEL subroutine.
}
